<div class="container mt-4">
  <h2>Manage Users</h2>
  <div *ngIf="successMessage" class="alert alert-success">
    {{ successMessage }}
  </div>
  
  <table class="table table-bordered table-striped">
    <thead class="table-dark">
      <tr>
        <th>First Name</th>
        <th>Last Name</th>
        <th>Email</th>
        <th>Store</th>
        <th>Phone</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let user of users">
        <td>{{ user.firstname | capitalize}}</td>
        <td>{{ user.lastname | capitalize }}</td>
        <td>{{ user.email }}</td>
        <td>{{ user.store }}</td>
        <td>{{ user.phone }}</td>
        <td>
          <button class="btn btn-primary me-2" (click)="editUser(user)"><i class="bi bi-pencil-fill"></i>&nbsp;Update</button>
          <button class="btn btn-danger" (click)="openDeleteConfirmation(user.Id)"><i class="bi bi-trash-fill"></i>&nbsp;Delete</button>
        </td>
      </tr>
    </tbody>
  </table>

  <!-- Modal for updating user -->
  <div *ngIf="showModal" class="modal fade show" style="display: block;">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Update User</h5>
          <button type="button" class="btn-close" (click)="closeModal()"></button>
        </div>
        <div class="modal-body">
          <form (ngSubmit)="updateUser()">
            <div class="mb-3">
              <label for="firstname" class="form-label">First Name:</label>
              <input id="firstname" [(ngModel)]="selectedUser.firstname" name="firstname" class="form-control" required />
            </div>
            <div class="mb-3">
              <label for="lastname" class="form-label">Last Name:</label>
              <input id="lastname" [(ngModel)]="selectedUser.lastname" name="lastname" class="form-control" required  />
            </div>
            
            <div class="mb-3">
              <label for="email" class="form-label">Email:</label>
              <input id="email" [(ngModel)]="selectedUser.email" name="email" class="form-control" required readonly />
            </div>
            <div class="mb-3">
              <label for="store" class="form-label">Store:</label>
              <input id="store" [(ngModel)]="selectedUser.store" name="store" class="form-control" readonly />
            </div>
            <div class="mb-3">
              <label for="phone" class="form-label">Phone:</label>
              <input id="phone" [(ngModel)]="selectedUser.phone" name="phone" class="form-control" required />
            </div>
            <button type="submit" class="btn btn-primary">Update&nbsp;<i class="bi bi-pencil-fill"></i></button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Confirmation Modal for Delete -->
  <div *ngIf="showDeleteConfirmation" class="modal fade show" style="display: block;">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Confirm Deletion</h5>
          <button type="button" class="btn-close" (click)="closeDeleteConfirmation()"></button>
        </div>
        <div class="modal-body">
          <p>Are you sure you want to delete this user?</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-danger me-2" (click)="deleteUser()">Yes, Delete</button>
          <button type="button" class="btn btn-danger" (click)="closeDeleteConfirmation()">Cancel</button>
        </div>
      </div>
    </div>
  </div>
</div>
